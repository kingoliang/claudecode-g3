#!/usr/bin/env node

/**
 * Version injection script
 * Reads version from package.json and generates src/utils/version.ts
 * This ensures a single source of truth for the framework version.
 */

import { readFileSync, writeFileSync } from 'fs';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);
const rootDir = join(__dirname, '..');

// Read version from package.json
const packageJsonPath = join(rootDir, 'package.json');
const pkg = JSON.parse(readFileSync(packageJsonPath, 'utf-8'));
const version = pkg.version;

// Generate version constant file
const versionContent = `// Auto-generated by scripts/inject-version.js - DO NOT EDIT MANUALLY
// Source: package.json version field

/** Current framework version (synced from package.json) */
export const FRAMEWORK_VERSION = '${version}';
`;

const outputPath = join(rootDir, 'src/utils/version.ts');
writeFileSync(outputPath, versionContent, 'utf-8');

console.log(`Version ${version} injected into src/utils/version.ts`);
